<!DOCTYPE html>
<html>
<head>
<title>App Login and post</title>
<meta charset="UTF-8">
</head>
<body>
	<script>
		function statusChangeCallback(response) {
			if (response.status === 'connected') {
				testAPI();
				document.getElementById("leButton").style.display = "none";
				postLike();
			} else if (response.status === 'not_authorized') {
				document.getElementById('status').innerHTML = 'Please log '
						+ 'into this app.';
			} else {
				document.getElementById('status').innerHTML = 'Please log '
						+ 'into Facebook.';
			}
			console.log('done');
		}

		function checkLoginState() {
			FB.getLoginStatus(function(response) {
				statusChangeCallback(response);
			});
		}

		window.fbAsyncInit = function() {
			FB.init({
				appId : '408578959324906',
				cookie : true,
				xfbml : true,
				version : 'v2.2'
			});

			FB.getLoginStatus(function(response) {
				statusChangeCallback(response);
			});

		};

		(function(d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id))
				return;
			js = d.createElement(s);
			js.id = id;
			js.src = "//connect.facebook.net/en_US/sdk.js";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));

		function testAPI() {

			console.log('Welcome!  Fetching your information.... ');
			FB
					.api(
							'/me',
							function(response) {
								console.log('Successful login for: '
										+ response.name);
								document.getElementById('status').innerHTML = 'Thanks for logging in, '
										+ response.name + '!'
								consloe.log(response)
							});

			//                FB.api(
			//                        "/me/feed",
			//                        {
			//                            "filter": "app_2915120374"
			//                        },
			//                function(response) {
			//                    if (response && !response.error) {
			//                        alert(JSON.stringify(response));
			//                        document.getElementById("intext").value = response;
			//                        //document.getElementById("clickme").click();
			//                        
			//                        console.log(response);
			//                    }
			//                    console.log(response+" Aawa");
			//                }
			//                );

		}

		function postLike() {
			var track = {
				'fb:app_id' : "408578959324906",
				'og:title' : 'My Track',
				'og:image' : "http://www.envirocar.ca/images/EnviroCar_Map_2.png",
				'og:url' : 'http://samples.ogp.me/409885052527630',
				'og:type' : "sentiment_codeelite:track",
				'og:image:width' : 512,
				'og:image:height' : 512,
				'sentiment_codeelite:speed' : 12,
				'sentiment_codeelite:emission' : 25
			};
			FB
					.api(
							'https://graph.facebook.com/me/sentiment_codeelite:shared',
							'post',
							{
								track : track,
								privacy : {
									'value' : 'EVERYONE'
								}
							},
							function(response) {
								if (!response) {
									alert('Error occurred.');
								} else if (response.error) {
									document.getElementById('result').innerHTML = 'Error: '
											+ response.error.message;
								} else {
									document.getElementById('result').innerHTML = '<a href=\"https://www.facebook.com/me/activity/' +
             response.id + '\">'
											+ 'Story created.  ID is '
											+ response.id + '</a>';
								}
							});
		}

		/*$.post(
		 'https://graph.facebook.com',
		 {
		 id: 'http://www.envirocar.ca/images/EnviroCar_Map_2.png',
		 scrape: true
		 },
		 function(response){
		 console.log(response);
		 }
		 );*/
	</script>
	<div id="leButton">
		<fb:login-button
			scope="public_profile,email,user_status,publish_actions"
			onlogin="checkLoginState();">
		</fb:login-button>
	</div>

	<div id="myDiv"></div>
	<div id="result"></div>
</body>
</html>